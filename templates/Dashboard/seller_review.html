{% include  'base.html' %}
{% load static %}
{% block contentarea%}
<title>Letworkbedone - Seller Review</title>
<link rel="stylesheet" href="{% static 'assets/css/frontend/payments.css' %}" type="text/css" />
<link rel="stylesheet" href="{% static 'assets/css/frontend/seller_review.css' %}" type="text/css" />
<div class="all_page page-flex__content pt0 m0">
    <div id="event_list" class="event-list js-event-list"></div>
    <div id="fox_notification_block"></div>
    <div class="row justify-content-center mt-0" id="manage_payments">
        <div class="col-11 text-center p-0 mt-3 mb-2">
        <div id="perseus-app" class="payments_perseus">
            <span class="payments-sdk-package">
               <div class="payment-page">
                  <header class="header-package fiverr-header">
                     <div class="header-row-wrapper">
                        <div class="header-row max-width-container equal-padding row-main">
                           <button class="btn-navicon js-side-nav-trigger">
                              <svg xmlns="http://www.w3.org/2000/svg" width="23" height="19" viewBox="0 0 23 19">
                                 <rect y="16" width="23" height="3" rx="1.5" fill="#555"></rect>
                                 <rect width="23" height="3" rx="1.5" fill="#555"></rect>
                                 <rect y="8" width="23" height="3" rx="1.5" fill="#555"></rect>
                              </svg>
                           </button>
                           <a href="{% url 'index' %}" class="site-logo">
                              <img class="js-header-theme-logo" src="{{logo_image_url}}" height="40" width="160" alt="mobile logo"/>
                           </a>
                         
                        </div>
                     </div>
                  </header>
                  <div class="loadable">
                    <div class="row justify-content-center mt-0">
                        <div class="col-10 text-center p-0 mt-3 mb-2">
                           <article class="payment-methods" id="seller_review_section">
                              <div class="cash">
                                 <div class="radio-group">
                                    <article class="payment-methods">
                                        <section class="summary">
                                            <form id="form_seller_review">
                                            <div class="row tab7" >                                               
                                                <div class="col-lg-9">
                                                    <h4  class="header_txt">
                                                        Public Review
                                                     </h4>
                                                     <label class="message">
                                                        Share your experience with the community, to help them make better decisions.
                                                     </label>
                                                </div>
                                                <div class="col-lg-3">
                                                   
                                                </div>
                                             </div>
                                             <div class="row tab7 mt-5 mb-5" >
                                                <div class="col-lg-6">
                                                    <h5  class="header_txt1">
                                                        Communication with Seller
                                                     </h5>
                                                     <label class="message1">
                                                        How responsive was the seller during the process?
                                                     </label>
                                                </div>
                                                <div class="col-lg-3">
                                                    <select id="responsive" name="rating" required>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                    </select>
                                                </div>
                                             </div>
                                             <div class="row tab7 mt-3 mb-5" >
                                                <div class="col-lg-6">
                                                    <h5  class="header_txt1">
                                                        Service as Described
                                                     </h5>
                                                     <label class="message1">
                                                        Did the results match the Gig Description?
                                                     </label>
                                                </div>
                                                <div class="col-lg-3">
                                                    <select id="service" name="rating" required>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                    </select>
                                                </div>
                                             </div>

                                             <div class="row tab7 mt-3 mb-5" >
                                                <div class="col-lg-6">
                                                    <h5  class="header_txt1">
                                                        Buy Again or Recommend
                                                     </h5>
                                                     <label class="message1">
                                                        Would you recommend buying this Gig?
                                                     </label>
                                                </div>
                                                <div class="col-lg-3">
                                                    <select id="recommend" name="rating" required>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                    </select>
                                                </div>
                                             </div>
                                             <div class="row tab7 mt-3 mb-5" >
                                                <div class="col-lg-8">
                                                    <h5  class="header_txt1">
                                                        What was it like working with this seller?
                                                     </h5>
                                                     <textarea maxlength="{{seller_descp_count}}" placeholder="why did you buy this Gig? Did the seller helped you to achieve your Goal." id="textarea_seller_desc" required></textarea>
                                                    <span class="seller_desc_count">0 / {{seller_descp_count}} max</span>
                                                </div>
                                                <div class="col-lg-3"> 
                                                </div>
                                             </div>
                                             <div class="row tab7 mt-3 mb-5" >
                                                <div class="col-lg-6">

                                                </div>
                                                <div class="col-lg-3" style="text-align:right;">
                                                    <button type="submit" class="mt-3 agqrXOY BvNepr1 r+NFCla co-white pay-button bg-co-green-700" id="buyer_rev_submit">Submit Review</button>
                                                </div>
                                             </div>
                                             <div class="row tab7 mt-3 mb-5" >
                                                <div class="col-lg-7">
                                                    <div class="error-message-review">
                                                        <span class="error">Please fill all the details.</span>
                                                    </div> 
                                                </div>
                                            </div>
                                            </form>
                                        </section>
                                    </article>

                                 </div>
                              </div>
                           </article>
                           <article class="payment-methods" id="thank_section">
                            <div class="cash">
                                <div class="radio-group">
                                   <article class="payment-methods">
                                       <section class="summary">
                                           <div class="row tab7" >
                                               <div class="col-lg-9">
                                                    <h1>Thank you for your review</h1>
                                                    <article>
                                                       <i class="fa fa-check-circle-o"></i>
                                                       <p class="p-t-20"> It's customary to leave a tip for the seller's service <b>{{order_details.order_to.username}}</b> and encourage him to do good work.</p>
                                                       <p class="mt-3">
                                                        <button type="button" class="mt-3 agqrXOY BvNepr1 r+NFCla co-white pay-button bg-co-green-700" id="buyer_tip_review" >Tip Now</button>
                                                       </p>
                                                    </article>
                                               </div>
                                            </div>
                                            </div>
                                       </section>
                                   </article>

                                </div>
                             </div>
                            </article>
                        </div>
                      
                    </div>
                  </div>
               </div>
            </span>
         </div> 
    
        </div>
    </div>
 </div>
{% include  'Dashboard/base_buyer.html' %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-bar-rating/1.2.2/themes/fontawesome-stars.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bar-rating/1.2.2/jquery.barrating.min.js"></script>
<script>
    $(document).ready(function(){
        $(".error-message-review").hide();
        $("#thank_section").hide();
        $('#responsive').barrating({ theme: 'fontawesome-stars',initialRating: '0',allowEmpty: false,emptyValue: '',deselectable: true,onSelect: function(value, text, event) {
            if (typeof(event) !== 'undefined') {
                responsive_rating = value;
            } 
        }});
        $('#service').barrating({ theme: 'fontawesome-stars',initialRating: '0',allowEmpty: false,emptyValue: '',deselectable: true,onSelect: function(value, text, event) {
            if (typeof(event) !== 'undefined') {
                service_rating = value;
            } 
        }});
        $('#recommend').barrating({ theme: 'fontawesome-stars',initialRating: '0',allowEmpty: false,emptyValue: '',deselectable: true,onSelect: function(value, text, event) {
            if (typeof(event) !== 'undefined') {
                recommend_rating = value;
            } 
        }});
        $('#textarea_seller_desc').on('keyup', 'paste', function() { 
            setTimeout(function() {
            var thisChars = this.value.replace(/{.*}/g, '').length; 
            var maxlength = $(this).attr("maxlength");
            if(thisChars > maxlength) 
            {
               var CharsToDel = (thisChars-maxlength); 
               this.value = this.value.substring(0,this.value.length-CharsToDel); 
            }else{
               $(".seller_desc_count").text( maxlength - thisChars + " /"+maxlength  +" max" ); 
            }
        }, 500);  
         });
        $("#buyer_tip_review").click(function(){
            location_href =  $(location).attr('href').split("/");
            window.open(location_href[0]+"//"+location_href[2] + '/{{request.user.username}}/tips/{{order_details.order_no}}' ,"_self");
        });
        $("#form_seller_review").submit(function(e)
        {
            e.preventDefault();
            if(responsive_rating.length != 0 && service_rating.length != 0 && recommend_rating.length != 0 )
            {
                $(".error-message-review").hide();
                $.ajax({
                    type:"GET",
                    url: "/post_seller_review/",
                    data: {"order_no":'{{order_no}}',"s_comm":responsive_rating,"s_serv":service_rating,"s_recomm":recommend_rating,"s_review_txt":$("#textarea_seller_desc").val()},
                    success: function(data) 
                    {
                        jsonObject = JSON.parse(JSON.stringify(data));
                        if(jsonObject['sucess'] == "sucess")
                        {
                            $("#seller_review_section").hide();
                            $("#thank_section").show();
                            $(".error-message-review").hide();
                        } 
                    }
                });
            }
            else{
                $(".error-message-review").show();
            }
        });
    });

</script>
{% endblock %}